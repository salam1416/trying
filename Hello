"""
Questions for the project
Q1: Do minorities make up a higher percentage of whites in executions?
A1: A little bit higher; 273/498 = 54% is the percentage for minorities 
    in executions Meanwhile, white percentage in execution is 46%. 
Q2: Do minorities killing whites make up a higher or lower percentage of executions than whites
    killing minorities? 
A2: Miniorities killing white has higher percentage It is 28 Minority-on-white wheras
    7 White-on-minority. 
Q3: Do men killing women make up a higher or lower percentage of executions than women killing
    men?
A3: Men killing women has much higher percentage, 65 Male-on-female whereas vs
    0 Female-on-male. Meanwhile, female make an almost equal percentage with
    men in the overall population
Q4: Do men make up a higher or lower percentage of executions than women? 
A4: Yes, it's 119 male vs 1 female; whereas their percentage in the overall
    population is almost the same
"""
###########################################################
#  Computer Project #6
#
#  Algorithm
#    prompt for a file name, make sure this file exist and then open it
#       Extract what we want from file (Gender, Race, Victim info)
#    Get a count for the murderer race and gender
#    Get a count for murderer and his/her victim racees and genders
#    Organize the results
############################################################
# importing cvs package which will help us extract a list from our file
import csv  
def open_file():
    """
    Ask for file name and make sure this file exist
    Open file for reading
    """
    name=input('Enter a file name: ')
    while True:
        try:
            # Openning file for reading
            fp =open(name, 'r')
            break
        # if this error is found, print a message and ask for another input
        except FileNotFoundError:
            print("Error. Please try again")
            name=input('Enter a file name: ')
            continue
    return fp
  
def read_file():
    ''' Extract a list of tuples of Race, Gender of the murderer as well as
    the victim race and gender '''
    file = open_file()
    # cvs package method that seperate cvs files into lists
    csv_file = csv.reader(file)
    list_Tuples_RGV = []
    for line in csv_file:
        # make everything in lowercase from the beginning
        T = (line[15].lower() , line[16].lower() , line[27].lower() )
        list_Tuples_RGV.append(T)
    file.close() # closing the file
    list_Tuples_RGV.pop(0) # removing the header
    return list_Tuples_RGV

def murderer_race_gender(RVG):
    ''' This function counts the number of white, balck, hispanic, male, and female murderer
    RVG : the list of tuples of (race, gender , victim race and gender)
    Return: number of whites, blacks, hispanics muderers and thier sum
    Return: the number of male and female murerers '''
    # Define the counter as zero; ct is counter
    ct_white, ct_black, ct_hispanic = 0, 0, 0
    ct_male, ct_female = 0,0
    # loop through the list and count each using if functions
    for element in RVG:
        # Race coutning
        if element[0] == 'white':
            ct_white+=1
        elif element[0] == 'black':
            ct_black+=1
        elif element[0] == 'hispanic':
            ct_hispanic+=1
        # Gender counting
        if element[1]== 'male':
            ct_male +=1
        elif element[1] == 'female':
            ct_female +=1
    # Count the sum of all races
    All_murderer_race = ct_white + ct_black + ct_hispanic
    return All_murderer_race, ct_white, ct_black, ct_hispanic, ct_male, ct_female


def race_difference(RVG):
    ''' This function removes people that have missing information in their race, gender
    for both murderer and victim, then it does some couting. 
    RVG : the list of tuples of (race, gender , victim race and gender)
    Return: number of people with complete information, murderer from minorities 
    that killed white and vice versa, male killed female and vice versa, 
    and lastly white that killed minorities. '''
    diff_race = 0
    complete_info=[]
    for ele in RVG:
        # append list that doesn't have "Not Available" and blank '' in them
        if 'not available' not in ele and (ele[0] and ele[1] and ele[2]) != '':
            complete_info.append((ele[0], ele[1], ele[2]))
            diff_race+=1
    Minority_on_white, White_on_minority = 0, 0
    Male_on_female, Female_on_male = 0, 0
    for ele in complete_info:
        # Murderer is in minorities and victim is white
        if ele[0] in 'black hispanic' and 'white' in ele[2]:
            Minority_on_white+=1
        # Muderer is male and victim is female; then vice versa
        if ele[1] == 'male' and  'female' in ele[2]:
            Male_on_female+=1
        if ele[1] == 'female' and  ' male' in ele[2]:
            Female_on_male+=1
        # Murderer is white and victim is minority
        if ele[0] == 'white' and ('black' in ele[2] or 'hispanic' in ele[2]) :
            White_on_minority+=1
    return diff_race, Minority_on_white, Male_on_female, Female_on_male, \
    White_on_minority
        
# RGV stands for Race, Gender, Victim
# RGV_list is a list of tuples that contain Race and Gender for killer and victim
RGV_list = read_file()

# Prining and formatin the output. 
All_murderer_race, ct_Wh, ct_Bk, ct_Hs, ct_male, ct_female = murderer_race_gender(RGV_list)
print("="*40  ,'\n White vs. Minority ')
print(' N = {} \n White: {} \n Black: {} \n Hispanic: {} \n Minority = Black\
 + Hispanic: {}'.format(All_murderer_race, ct_Wh, ct_Bk, ct_Hs, ct_Bk+ct_Hs ))
 
print("="*40 ,'\n Male vs. Female ')
print(' N = {} \n Male: {} \n Female: {}'.format(ct_male+ct_female ,ct_male, ct_female))

diff_race, Minority_on_white, Male_on_female,\
Female_on_male, White_on_minority = race_difference(RGV_list)
print("="*40 ,'\nRace difference between perpetrator and victim. ')
print(' N = {} \n Minority-on-white: {} \n Male-on-female: {} \n\
 Female-on-male: {} \n White-on-minority: {} '.format(diff_race \
,Minority_on_white, Male_on_female, Female_on_male, White_on_minority))

############################################################
# Survey questions: 
# Q1: 7
# Q2: 5
# Q3: 2
# Q4: 7
